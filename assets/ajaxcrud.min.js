<<<<<<< HEAD
/*!
 * Ajax Crud 
 * =================================
 * Use for johnitvn/yii2-ajaxcrud extension
 */!function(t){t.fn.ajaxCrud=function(){function e(){t(p).modal("toggle")}function a(a){var o=t.extend({type:"default",title:"",closeButton:!0,loading:!0,url:"create",method:"GET",positiveButton:null,negativeButton:null,onPositiveClick:null,onNegativeClick:null},a);t(p).find(".modal-dialog").addClass("modal-"+o.type),o.loading&&(t(p).find(".modal-header .modal-title").remove(),t(p).find(".modal-header").append('<div class="modal-title"><h4 class="modal-title">Loading</h4></div>'),t(p).find(".modal-body").html('<div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div>')),o.closeButton||t(p).find(".modal-title button.close").remove(),t(p).modal(),t.ajax({url:o.url,method:o.method,error:function(e,a,o){t(p).find(".modal-header .modal-title").remove(),t(p).find(".modal-header").append('<div class="modal-title"><h4 class="modal-title">'+a.capitalizeFirstLetter()+" - "+o+"</h4></div>"),t(p).find(".modal-body").html(e.responseText)},success:function(a){t(p).find(".modal-header .modal-title").remove(),t(p).find(".modal-header").append('<div class="modal-title"><h4 class="modal-title">'+o.title+"</h4></div>"),t(p).find(".modal-body").html(a.data),(null!=o.positiveButton||null!=o.negativeButton)&&(modalFooter=document.createElement("div"),modalFooter.setAttribute("class","modal-footer"),t(p).find(".modal-content").append(modalFooter),null!=o.positiveButton&&(positiveButtonElm=document.createElement("button"),positiveButtonElm.setAttribute("class","btn btn-primary"),positiveButtonElm.innerHTML=o.positiveButton,t(modalFooter).append(positiveButtonElm),null!=o.onPositiveClick&&t(positiveButtonElm).click(function(t){o.onPositiveClick(t)})),null!=o.negativeButton&&(negativeButtonElm=document.createElement("button"),negativeButtonElm.setAttribute("class","btn btn-default pull-left"),negativeButtonElm.innerHTML=o.negativeButton,t(modalFooter).append(negativeButtonElm),t(negativeButtonElm).click(function(t){e(),null!=o.onNegativeClick&&o.onNegativeClick(t)}))),t(this).find("form").submit(function(t){t.preventDefault()})}})}function o(){$modalDialog=t(p).find(".modal-dialog"),$modalDialog.attr("class",""),$modalDialog.addClass("modal-dialog"),t(p).find(".modal-footer").remove(),t(p).find(".modal-body").html(""),t(p).find(".modal-title").html("")}function i(){t.pjax.reload({container:b})}function l(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}function n(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function d(e){e.preventDefault(),a({url:t(B).attr("href"),title:t(B).hasAttr("data-modal-title")?t(B).attr("data-modal-title"):"Create new",positiveButton:t(B).hasAttr("data-modal-positive")?t(B).attr("data-modal-positive"):"Save",negativeButton:t(B).hasAttr("data-modal-negative")?t(B).attr("data-modal-negative"):"Cancel",onPositiveClick:h})}function s(a){return a.preventDefault(),confirm(t(this).attr("data-confirm-message"))&&(t(p).find(".modal-header .modal-title").remove(),t(p).find(".modal-header").append('<div class="modal-title"><h4 class="modal-title">Loading</h4></div>'),t(p).find(".modal-body").html('<div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div>'),t(p).modal(),t.ajax({url:t(this).attr("href"),method:t(this).attr("data-method"),success:function(){i(),e()}})),!1}function r(e){e.preventDefault();var i=this;a({url:t(this).attr("href"),title:t(this).hasAttr("data-modal-title")?t(this).attr("data-modal-title"):"View",positiveButton:t(this).hasAttr("data-modal-positive")?t(this).attr("data-modal-positive"):"Edit",negativeButton:t(this).hasAttr("data-modal-negative")?t(this).attr("data-modal-negative"):"Close",onPositiveClick:function(){o(),t(i).parent().find(".update-action-button").trigger("click")}})}function c(e){e.preventDefault(),a({url:t(this).attr("href"),title:t(this).hasAttr("data-modal-title")?t(this).attr("data-modal-title"):"Update",positiveButton:t(this).hasAttr("data-modal-positive")?t(this).attr("data-modal-positive"):"Save",negativeButton:t(this).hasAttr("data-modal-negative")?t(this).attr("data-modal-negative"):"Cancel",onPositiveClick:f})}function u(a){a.preventDefault();var o=[];return t('input:checkbox[name="selection[]"]').each(function(){this.checked&&o.push(t(this).val())}),0==o.length?!1:(confirm(t(x).attr("data-confirm-message"))&&(t(p).find(".modal-header .modal-title").remove(),t(p).find(".modal-header").append('<div class="modal-title"><h4 class="modal-title">Loading</h4></div>'),t(p).find(".modal-body").html('<div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div>'),t(p).modal(),t.ajax({url:t(x).attr("href"),method:t(x).attr("data-method"),data:{pks:JSON.stringify(o)},success:function(){i(),e()}})),!1)}function m(){t(window).data("fullscreen-state")?n():l(document.getElementById(b.substring(1)))}function f(){var e=t(p).find("form");t.ajax({url:t(e).attr("action"),method:t(e).attr("method"),data:t(e).serialize(),success:function(e){200==e.code?(i(),t(p).find(".modal-dialog").addClass("modal-success"),t(p).find(".modal-body").html(e.message),$successNegativeButton=t(y).hasAttr("data-modal-negative-success")?t(this).attr("data-modal-negative-success"):"Close",t(p).find(".modal-footer .btn-default").html($successNegativeButton),t(p).find(".modal-footer .btn-primary").remove()):400==e.code&&t(p).find(".modal-body").html(e.data)}})}function h(){var e=t(p).find("form");t.ajax({url:t(e).attr("action"),method:t(e).attr("method"),data:t(e).serialize(),success:function(e){200==e.code?(i(),t(p).find(".modal-dialog").addClass("modal-success"),t(p).find(".modal-body").html(e.message),$successNegativeButton=t(B).hasAttr("data-modal-negative-success")?t(this).attr("data-modal-negative-success"):"Close",t(p).find(".modal-footer .btn-default").html($successNegativeButton),$successPositiveButton=t(B).hasAttr("data-modal-positive-success")?t(this).attr("data-modal-positive-success"):"Create other",t(p).find(".modal-footer .btn-primary").html($successPositiveButton),t(p).find(".modal-footer .btn-primary").click(function(t){o(),d(t)})):400==e.code&&t(p).find(".modal-body").html(e.data)}})}function v(e){e.preventDefault();var a=this;return t(a).hasAttr("data-confirm-message")&&!confirm(t(this).attr("data-confirm-message"))?!1:(t.ajax({url:t(a).attr(t(a).hasAttr("href")?"href":"data-url"),method:t(a).attr("data-method"),error:function(t){alert(t.responseText)},success:function(e){t(a)[0].outerHTML=e}}),!1)}var p="#ajaxCrubModal",g="#ajaxCrudDatatable",b="#crud-datatable-pjax",B=".create-action-button",C=".delete-action-button",y=".update-action-button",k=".view-action-button",x=".btn-bulk-delete",F=".btn-toggle-fullscreen",A=".btn-toggle";t.fn.hasAttr=function(t){return void 0!==this.attr(t)},String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},t(window).bind("fullscreen-on",function(){t(F).find("i").removeClass("glyphicon-resize-full"),t(F).find("i").addClass("glyphicon-resize-small")}),t(window).bind("fullscreen-off",function(){t(F).find("i").removeClass("glyphicon-resize-small"),t(F).find("i").addClass("glyphicon-resize-full")}),t(g).on("click",B,d),t(g).on("click",C,s),t(g).on("click",k,r),t(g).on("click",y,c),t(g).on("click",x,u),t(g).on("click",F,m),t(p).on("hidden.bs.modal",o),t(g).on("click",A,v)},t("#ajaxCrudDatatable").ajaxCrud()}(jQuery);